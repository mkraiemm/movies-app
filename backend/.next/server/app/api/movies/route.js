"use strict";(()=>{var e={};e.id=992,e.ids=[992],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},2047:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>g,patchFetch:()=>y,requestAsyncStorage:()=>v,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>d});var i=t(5419),a=t(9108),o=t(9678),n=t(8070),u=t(5643),p=t(2002);async function l(e){let r=e.headers.get("Authorization");if(!r?.startsWith("Bearer "))return n.Z.json({error:"Unauthorized"},{status:401});let t=r.split(" ")[1],s=(0,p.W)(t);if(!s)return n.Z.json({error:"Unauthorized"},{status:401});let i=(await u.t.getMovies()).filter(e=>e.userId===s.userId);return n.Z.json(i)}async function d(e){let r=e.headers.get("Authorization");if(!r?.startsWith("Bearer "))return n.Z.json({error:"Unauthorized"},{status:401});let t=r.split(" ")[1],s=(0,p.W)(t);if(!s)return n.Z.json({error:"Unauthorized"},{status:401});try{let r=await e.json(),t=await u.t.getMovies(),i={id:Date.now().toString(),...r,userId:s.userId};return t.push(i),await u.t.saveMovies(t),n.Z.json(i)}catch(e){return n.Z.json({error:"Invalid request"},{status:400})}}let c=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/movies/route",pathname:"/api/movies",filename:"route",bundlePath:"app/api/movies/route"},resolvedPagePath:"D:\\Upwork\\Movies App\\movies-app\\backend\\src\\app\\api\\movies\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:f,serverHooks:h,headerHooks:m,staticGenerationBailout:w}=c,g="/api/movies/route";function y(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},2002:(e,r,t)=>{t.d(r,{R:()=>a,W:()=>o});var s=t(6082);let i="your-secret-key";function a(e){return(0,s.sign)({userId:e},i,{expiresIn:"7d"})}function o(e){try{return(0,s.verify)(e,i)}catch{return null}}},5643:(e,r,t)=>{t.d(r,{t:()=>p});let s=require("fs");var i=t(1017),a=t.n(i);let o=a().join(process.cwd(),"data"),n=a().join(o,"users.json"),u=a().join(o,"movies.json");(async function(){try{await s.promises.mkdir(o,{recursive:!0}),await s.promises.writeFile(n,"[]",{flag:"wx"}),await s.promises.writeFile(u,"[]",{flag:"wx"})}catch(e){}})();let p={getUsers:async()=>JSON.parse(await s.promises.readFile(n,"utf8")),async saveUsers(e){await s.promises.writeFile(n,JSON.stringify(e,null,2))},getMovies:async()=>JSON.parse(await s.promises.readFile(u,"utf8")),async saveMovies(e){await s.promises.writeFile(u,JSON.stringify(e,null,2))}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,206,82],()=>t(2047));module.exports=s})();